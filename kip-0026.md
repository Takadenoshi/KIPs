---
KIP: 0026
Title: Key Derivation and Mnemonic encoding methods
Author: Tasos Bitsios @Takadenoshi
Status: Draft
Type: Standard
Category: Application
Created: 2023-11-21
---

# Abstract

We propose the following key derivation and mnemonic encoding methods for Chainweb keys:

- Derivation: SLIP-10 with derivation path `m/44'/626'/a'`.
- Mnemonics: BIP-39, 24 words, English wordlist, empty passphrase.

# Motivation

Convergence on these standards will ensure key and mnemonic interoperability between wallet providers. This will benefit users of all wallet types (hot/hardware/cold), who will be able to reuse their keys or phrases without requiring conversion.

# Specification

## Key Derivation

We recommend following the widely adopted standard for deriving ED25519 keypairs: [SLIP-0010](https://github.com/satoshilabs/slips/blob/master/slip-0010.md).

We recommend the following derivation path:

`m/44'/626'/a'`

Where `a'` is the account iterator starting at zero. E.g. the first account would be derived using path `m/44'/626'/0'`, the second account would be derived using `m/44'/626'/1'`, and so on.

## Mnemonic Encoding

We recommend following the adopted standard for encoding private keys to mnemonic seed phrases: [BIP-0039](https://github.com/bitcoin/bips/blob/master/bip-0039.mediawiki) with 24 words, using the English BIP39 wordlist.

We recommend not using a pass phrase to encrypt the mnemonic.

# Rationale

## Key Derivation

Rationale for choosing SLIP-10:

- SLIP-10 is the most widely adopted derivation standard and algorithm for ED25519 curve blockchain keypairs.
- A custom or exotic derivation algorithm would have been a hindrance a contrained environments such as hardware wallets, where a non-standard algorithm will commonly require a firmware upgrade.
- A standard derivation algorithm will reduce friction for multi-chain wallet integrations, as those will often support SLIP-10 derivation already, without the need to include (and audit) a custom library.

The three-level derivation path `m/44'/626'/a'` was chosen after a number of considerations:

- As simple as needs be, and no more: the fourth (change) and fifth (address index) levels of BIP-44 are superfluous for account-based blockchain keypairs.
  - Including them could result in confusion about the correct level to iterate for generating additional accounts beyond the first, leading to a situation where only the first account is interoperable between wallets.
  - Hardened vs not hardened: while SLIP-10 forbids non-hardened keys, there are libraries that do not enforce this. Including the last 2 BIP-44 levels would also create space for confusion between hardened and non-hardened path suffixes (e.g. `/0/0` and `/0'/0'`). This would produce different keys in wallets that accept the non-hardened derivation path, and the non-hardened paths would not be reproducible at all in wallets that use libraries that implement SLIP-10 strictly.
- Widely used for account-based blockchains' ED25519 keypairs. See Stellar, NEM, Monero and Tezos in the [list of Trezor BIP-44 derivation paths](https://docs.trezor.io/trezor-firmware/misc/coins-bip44-paths.html#list-of-used-derivation-paths).
- SLIP-10 compliant. BIP-44 specifies 5 levels, but SLIP-10 does not recommend a specific number of levels.
- `626` is the [SLIP-44](https://github.com/satoshilabs/slips/blob/master/slip-0044.md) coin type identifier for Kadena.

## Mnemonic Encoding

BIP-39 is nearly universally adopted as the mnemonic encoding method.

24 word mnemonics: support 256 bits of entropy.

The English BIP39 wordlist is recommended for interoperability.

Empty passphrase:

- Allows interoperability.
  - Few wallets implement encrypted mnemonic recovery.
- Encrypting a mnemonic with a passphrase may provide a sense of security, but:
  - A leaked encrypted mnemonic phrase can be quickly brute-forced offline ([BIP-39](https://github.com/bitcoin/bips/blob/master/bip-0039.mediawiki#from-mnemonic-to-seed): 2048 round PBKDF2 using salted HMAC-SHA512).
  - Users would have to store the encrypted mnemonic and passphrase separately to get any benefit at all.
  - Users forgetting their passphrase would likely not be able to recover it easily.

In all cases we would recommend the mnemonic phrase be treated as the secret to protect, encrypted or not.

# Reference Implementation

- [@kadena/hd-wallet](https://github.com/kadena-community/kadena.js/tree/main/packages/libs/hd-wallet)
- [ED25519-keygen](npmjs.com/ed25519-keygen) hdkey JS library ([Github](https://github.com/paulmillr/ed25519-keygen))

# Deviations

This specification recommends the default derivation method that wallets should implement, but does not discourage supporting additional methods as an advanced feature - with the understanding that the resulting keys or phrases will not be interoperable within the ecosystem.

**However, we strongly recommend that alternative derivation and encoding methods be publicly documented.** This will facilitate recoverability of keys and prevent permanent loss of user funds.

We further suggest using the SLIP-0010 derivation algorithm for the reasons outlined in the Rationale section.

# Test cases

TODO

# Backwards Compatibility

TODO

# References

- [SLIP-0010: Universal private key derivation from master private key](https://github.com/satoshilabs/slips/blob/master/slip-0010.md)
- [BIP-0044: Multi-Account Hierarchy for Deterministic Wallets](https://github.com/bitcoin/bips/blob/master/bip-0044.mediawiki)
- [BIP-0039: Mnemonic code for generating deterministic keys](https://github.com/bitcoin/bips/blob/master/bip-0039.mediawiki)
- [SLIP-0044: Registered coin types for BIP-0044](https://github.com/satoshilabs/slips/blob/master/slip-0044.md)
- [Trezor Firmware Docs: BIP-44 derivation paths](https://docs.trezor.io/trezor-firmware/misc/coins-bip44-paths.html#list-of-used-derivation-paths)
